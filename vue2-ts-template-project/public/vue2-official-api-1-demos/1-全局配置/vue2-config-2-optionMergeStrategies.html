<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vue 2 optionMergeStrategies è¯¦è§£</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      color: #fff;
      min-height: 100vh;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      max-width: 1200px;
      width: 100%;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
    }

    header {
      text-align: center;
      margin-bottom: 40px;
    }

    h1 {
      font-size: 2.8rem;
      margin-bottom: 15px;
      color: #ffcc00;
      text-shadow: 0 0 10px rgba(255, 204, 0, 0.3);
    }

    .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.6;
    }

    .content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 30px;
    }

    @media (max-width: 768px) {
      .content {
        grid-template-columns: 1fr;
      }
    }

    .panel {
      background: rgba(30, 30, 50, 0.7);
      border-radius: 10px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .panel-title {
      font-size: 1.8rem;
      margin-bottom: 20px;
      color: #4fc3f7;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .panel-title i {
      font-size: 1.5rem;
    }

    .code-block {
      background: #2d2d2d;
      color: #f8f8f2;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Fira Code', monospace;
      font-size: 0.95rem;
      overflow-x: auto;
      margin: 15px 0;
      border-left: 4px solid #4fc3f7;
      line-height: 1.6;
      white-space: pre-wrap;
      /* ä¿ç•™ç©ºæ ¼å’Œæ¢è¡Œï¼Œå¹¶è‡ªåŠ¨æ¢è¡Œ */
      word-break: break-all;
      /* å¿…è¦æ—¶åœ¨ä»»æ„å­—ç¬¦å¤„æ¢è¡Œ */
    }

    .console {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Fira Code', monospace;
      font-size: 0.9rem;
      height: 300px;
      overflow-y: auto;
      margin-top: 20px;
      border: 1px solid #444;
    }

    .console-line {
      margin-bottom: 5px;
      padding: 3px 0;
      border-bottom: 1px solid #333;
      white-space: pre-wrap;
    }

    .console-info {
      color: #90caf9;
    }

    .console-warning {
      color: #ffcc80;
    }

    .console-success {
      color: #a5d6a7;
    }

    .button {
      display: inline-block;
      background: linear-gradient(to right, #2196f3, #21cbf3);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 30px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      margin: 10px 5px;
      box-shadow: 0 4px 10px rgba(33, 150, 243, 0.3);
    }

    .button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(33, 150, 243, 0.5);
    }

    .button:active {
      transform: translateY(1px);
    }

    .explanation {
      margin-top: 20px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      line-height: 1.6;
    }

    .highlight {
      color: #ffcc00;
      font-weight: bold;
    }

    footer {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .demo-app {
      border: 2px dashed #4fc3f7;
      border-radius: 10px;
      padding: 15px;
      margin-top: 15px;
    }

    .demo-title {
      text-align: center;
      margin-bottom: 15px;
      color: #4fc3f7;
    }

    .result {
      background: rgba(0, 0, 0, 0.3);
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      border-left: 4px solid #ffcc00;
    }

    .result-title {
      font-weight: bold;
      margin-bottom: 10px;
      color: #ffcc00;
    }

    .option-list {
      list-style-type: none;
      padding: 10px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 5px;
    }

    .option-item {
      padding: 5px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .option-key {
      color: #90caf9;
      font-weight: bold;
    }

    .option-value {
      color: #a5d6a7;
    }

    .strategy-select {
      background: #2d2d2d;
      color: #fff;
      border: 1px solid #4fc3f7;
      border-radius: 5px;
      padding: 8px;
      width: 100%;
      margin: 10px 0;
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <h1>Vue 2 optionMergeStrategies è¯¦è§£</h1>
      <p class="subtitle">
        è¿™ä¸ªé¡µé¢å±•ç¤ºäº†Vue.jsä¸­<code>optionMergeStrategies</code>çš„ä½œç”¨å’Œä½¿ç”¨æ–¹æ³•ã€‚
        å®ƒå…è®¸å¼€å‘è€…è‡ªå®šä¹‰ç»„ä»¶é€‰é¡¹çš„åˆå¹¶ç­–ç•¥ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨mixinså’Œextendsæ—¶ã€‚
      </p>
    </header>

    <div class="content">
      <div class="panel">
        <h2 class="panel-title">âš™ï¸ è‡ªå®šä¹‰åˆå¹¶ç­–ç•¥</h2>

        <div class="code-block">
          // 1. è¦†ç›–é»˜è®¤çš„ç”Ÿå‘½å‘¨æœŸåˆå¹¶ç­–ç•¥ Vue.config.optionMergeStrategies.created = function (parent, child) { //
          é»˜è®¤è¡Œä¸ºï¼šåˆå¹¶ä¸ºæ•°ç»„ï¼Œä¾æ¬¡æ‰§è¡Œ // æˆ‘ä»¬æ”¹ä¸ºï¼šåªæ‰§è¡Œå­ç»„ä»¶çš„createdé’©å­ return child || parent; }; // 2.
          è‡ªå®šä¹‰é€‰é¡¹çš„åˆå¹¶ç­–ç•¥ Vue.config.optionMergeStrategies.customOption = function (parent, child) { //
          åˆå¹¶ä¸ºæ•°ç»„ const res = parent ? parent.slice() : []; if (child) { res.push(child); } return res; }; // 3.
          ç»§æ‰¿ç­–ç•¥ Vue.config.optionMergeStrategies.inheritOption = function (parent, child) { // å­ç»„ä»¶ä¼˜å…ˆ return
          child !== undefined ? child : parent; };
        </div>

        <div class="explanation">
          <p><span class="highlight">optionMergeStrategies</span> å…è®¸æˆ‘ä»¬ä¸ºæ¯ä¸ªç»„ä»¶é€‰é¡¹å®šä¹‰è‡ªå®šä¹‰çš„åˆå¹¶å‡½æ•°ã€‚</p>
          <p>å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š</p>
          <ul>
            <li><code>parentVal</code> - æ¥è‡ªçˆ¶çº§ï¼ˆmixin æˆ–åŸºç±»ï¼‰çš„å€¼</li>
            <li><code>childVal</code> - æ¥è‡ªå­ç»„ä»¶ï¼ˆå½“å‰ç»„ä»¶ï¼‰çš„å€¼</li>
          </ul>
          <p>è¿”å›å€¼å°†ä½œä¸ºè¯¥é€‰é¡¹çš„æœ€ç»ˆå€¼ã€‚</p>
        </div>

        <div class="demo-app">
          <h3 class="demo-title">ç­–ç•¥é€‰æ‹©å™¨</h3>

          <select id="strategy-select" class="strategy-select">
            <option value="default">é»˜è®¤ç­–ç•¥ï¼ˆåˆå¹¶ä¸ºæ•°ç»„ï¼‰</option>
            <option value="childOnly">ä»…ä½¿ç”¨å­ç»„ä»¶å€¼</option>
            <option value="concat">åˆå¹¶ä¸ºæ•°ç»„</option>
            <option value="sum">æ•°å€¼æ±‚å’Œ</option>
          </select>

          <button id="apply-strategy" class="button">åº”ç”¨å½“å‰ç­–ç•¥</button>

          <div class="result">
            <div class="result-title">å½“å‰åˆå¹¶ç­–ç•¥</div>
            <div id="current-strategy">é»˜è®¤ç­–ç•¥ï¼ˆåˆå¹¶ä¸ºæ•°ç»„ï¼‰</div>
          </div>
        </div>
      </div>

      <div class="panel">
        <h2 class="panel-title">ğŸ“Š åˆå¹¶ç»“æœæ¼”ç¤º</h2>

        <div class="demo-app">
          <div id="app">
            <div class="result">
              <div class="result-title">åˆå¹¶åçš„é€‰é¡¹å€¼</div>
              <ul class="option-list">
                <li class="option-item">
                  <span class="option-key">created é’©å­ï¼š</span>
                  <span class="option-value">{{ createdHooks }}</span>
                </li>
                <li class="option-item">
                  <span class="option-key">customOptionï¼š</span>
                  <span class="option-value">{{ customOption }}</span>
                </li>
                <li class="option-item">
                  <span class="option-key">numericOptionï¼š</span>
                  <span class="option-value">{{ numericOption }}</span>
                </li>
              </ul>
            </div>

            <button class="button" @click="triggerCreated">è§¦å‘ created é’©å­</button>
            <button class="button" @click="useCustomOption">ä½¿ç”¨ customOption</button>
          </div>
        </div>

        <div class="console" id="console-output">
          <div class="console-line console-info">æ§åˆ¶å°å‡†å¤‡å°±ç»ª...</div>
          <div class="console-line console-info">Vue.js å·²åŠ è½½</div>
        </div>
      </div>
    </div>

    <div class="panel">
      <h2 class="panel-title">ğŸ“š ä½¿ç”¨åœºæ™¯ä¸è¯´æ˜</h2>

      <div class="explanation">
        <h3>å¸¸è§ä½¿ç”¨åœºæ™¯ï¼š</h3>
        <ul>
          <li><span class="highlight">æ’ä»¶å¼€å‘</span> - ä¸ºæ’ä»¶å®šä¹‰çš„é€‰é¡¹æä¾›è‡ªå®šä¹‰åˆå¹¶é€»è¾‘</li>
          <li><span class="highlight">å¤§å‹é¡¹ç›®</span> - ç»Ÿä¸€ç®¡ç†æ··å…¥é€‰é¡¹çš„åˆå¹¶è¡Œä¸º</li>
          <li><span class="highlight">ç‰¹æ®Šéœ€æ±‚</span> - æ”¹å˜ç”Ÿå‘½å‘¨æœŸé’©å­çš„æ‰§è¡Œé¡ºåºæˆ–æ–¹å¼</li>
          <li><span class="highlight">è‡ªå®šä¹‰é€‰é¡¹</span> - ä¸ºé¡¹ç›®ç‰¹å®šçš„é€‰é¡¹å®šä¹‰åˆå¹¶ç­–ç•¥</li>
        </ul>

        <h3>Vue å†…ç½®ç­–ç•¥ç¤ºä¾‹ï¼š</h3>
        <div class="code-block">
          // ç”Ÿå‘½å‘¨æœŸé’©å­çš„é»˜è®¤ç­–ç•¥ function mergeHook(parentVal, childVal) { return childVal ? parentVal ?
          parentVal.concat(childVal) : Array.isArray(childVal) ? childVal : [childVal] : parentVal; } // data
          é€‰é¡¹çš„é»˜è®¤ç­–ç•¥ function mergeData(parentVal, childVal) { if (!childVal) return parentVal; if (!parentVal)
          return childVal; return function mergedDataFn() { return mergeData( typeof parentVal === 'function' ?
          parentVal.call(this) : parentVal, typeof childVal === 'function' ? childVal.call(this) : childVal ); }; }
        </div>

        <p class="highlight">æ³¨æ„ï¼šä¿®æ”¹å†…ç½®é€‰é¡¹çš„åˆå¹¶ç­–ç•¥å¯èƒ½ä¼šå½±å“æ¡†æ¶è¡Œä¸ºï¼Œè¯·è°¨æ…æ“ä½œã€‚</p>
      </div>
    </div>

    <footer>
      <p>Vue 2.6.14 | optionMergeStrategies æ¼”ç¤º | ç†è§£é€‰é¡¹åˆå¹¶ç­–ç•¥å¯¹é«˜çº§Vueå¼€å‘è‡³å…³é‡è¦</p>
    </footer>
  </div>

  <script>
    // è‡ªå®šä¹‰æ§åˆ¶å°è¾“å‡º
    const consoleOutput = document.getElementById('console-output')

    function logToConsole(message, type = 'info') {
      const line = document.createElement('div')
      line.className = `console-line console-${type}`
      line.textContent = message
      consoleOutput.appendChild(line)
      consoleOutput.scrollTop = consoleOutput.scrollHeight
    }

    // åˆå§‹æ—¥å¿—
    logToConsole('é¡µé¢åŠ è½½å®Œæˆ', 'info')
    logToConsole('Vue.config.optionMergeStrategies æ¼”ç¤ºå¼€å§‹', 'info')

    // å®šä¹‰ç­–ç•¥é€‰æ‹©å™¨
    const strategySelect = document.getElementById('strategy-select')
    const currentStrategyDisplay = document.getElementById('current-strategy')
    const applyStrategyBtn = document.getElementById('apply-strategy')

    // å½“å‰ç­–ç•¥çŠ¶æ€
    let currentStrategy = 'default'

    // åº”ç”¨ç­–ç•¥æŒ‰é’®
    applyStrategyBtn.addEventListener('click', function () {
      currentStrategy = strategySelect.value

      // æ›´æ–°æ˜¾ç¤º
      const strategyNames = {
        default: 'é»˜è®¤ç­–ç•¥ï¼ˆåˆå¹¶ä¸ºæ•°ç»„ï¼‰',
        childOnly: 'ä»…ä½¿ç”¨å­ç»„ä»¶å€¼',
        concat: 'åˆå¹¶ä¸ºæ•°ç»„',
        sum: 'æ•°å€¼æ±‚å’Œ'
      }
      currentStrategyDisplay.textContent = strategyNames[currentStrategy]

      logToConsole(`å·²åº”ç”¨ç­–ç•¥: ${strategyNames[currentStrategy]}`, 'success')
    })

    // 1. å®šä¹‰è‡ªå®šä¹‰åˆå¹¶ç­–ç•¥
    Vue.config.optionMergeStrategies.customOption = function (parentVal, childVal) {
      // é»˜è®¤è¡Œä¸ºï¼šåˆå¹¶ä¸ºæ•°ç»„
      const res = parentVal ? parentVal.slice() : []
      if (childVal) {
        res.push(childVal)
      }
      return res
    }

    // 2. å®šä¹‰æ•°å€¼é€‰é¡¹çš„åˆå¹¶ç­–ç•¥
    Vue.config.optionMergeStrategies.numericOption = function (parentVal, childVal) {
      // é»˜è®¤è¡Œä¸ºï¼šå­ç»„ä»¶è¦†ç›–çˆ¶ç»„ä»¶
      return childVal !== undefined ? childVal : parentVal
    }

    // 3. åˆ›å»ºå…¨å±€mixin
    Vue.mixin({
      created() {
        this.$options.createdHooks.push('å…¨å±€mixin created')
      },
      customOption: 'å…¨å±€mixin customOption',
      numericOption: 10
    })

    // 4. åˆ›å»ºæ··å…¥å¯¹è±¡
    const myMixin = {
      created() {
        this.$options.createdHooks.push('myMixin created')
      },
      customOption: 'myMixin customOption',
      numericOption: 5
    }

    // åˆ›å»ºVueåº”ç”¨
    new Vue({
      el: '#app',

      // åˆå§‹é€‰é¡¹å€¼
      data: {
        createdHooks: [],
        customOption: null,
        numericOption: null
      },

      // ä½¿ç”¨æ··å…¥
      mixins: [myMixin],

      // ç»„ä»¶é€‰é¡¹
      created() {
        this.$options.createdHooks.push('ç»„ä»¶è‡ªèº« created')

        // åˆå§‹æ˜¾ç¤ºåˆå¹¶åçš„é€‰é¡¹
        this.createdHooks = this.$options.createdHooks
        this.customOption = this.$options.customOption
        this.numericOption = this.$options.numericOption
      },

      methods: {
        triggerCreated() {
          // æ‰§è¡Œæ‰€æœ‰createdé’©å­
          this.$options.created.forEach((hook) => {
            if (typeof hook === 'function') {
              hook.call(this)
            }
          })

          logToConsole('æ‰§è¡Œäº†æ‰€æœ‰ created é’©å­å‡½æ•°', 'success')
        },

        useCustomOption() {
          if (Array.isArray(this.$options.customOption)) {
            const message = `customOption å€¼: ${this.$options.customOption.join(', ')}`
            logToConsole(message, 'info')
          } else {
            logToConsole(`customOption å€¼: ${this.$options.customOption}`, 'info')
          }
        }
      },

      // åŠ¨æ€åº”ç”¨åˆå¹¶ç­–ç•¥
      beforeCreate() {
        // æ ¹æ®é€‰æ‹©çš„ç­–ç•¥åŠ¨æ€ä¿®æ”¹åˆå¹¶ç­–ç•¥
        switch (currentStrategy) {
          case 'childOnly':
            Vue.config.optionMergeStrategies.created = function (parent, child) {
              return child || parent
            }
            Vue.config.optionMergeStrategies.customOption = function (parent, child) {
              return child
            }
            Vue.config.optionMergeStrategies.numericOption = function (parent, child) {
              return child
            }
            break

          case 'concat':
            Vue.config.optionMergeStrategies.created = function (parent, child) {
              const res = parent ? parent.slice() : []
              if (child) {
                res.push(child)
              }
              return res
            }
            Vue.config.optionMergeStrategies.customOption = function (parent, child) {
              const res = parent ? parent.slice() : []
              if (child) {
                res.push(child)
              }
              return res
            }
            break

          case 'sum':
            Vue.config.optionMergeStrategies.numericOption = function (parent, child) {
              return (parent || 0) + (child || 0)
            }
            break

          default: // 'default'
            // æ¢å¤é»˜è®¤ç­–ç•¥
            Vue.config.optionMergeStrategies.created = function (parentVal, childVal) {
              return childVal
                ? parentVal
                  ? parentVal.concat(childVal)
                  : Array.isArray(childVal)
                    ? childVal
                    : [childVal]
                : parentVal
            }
            Vue.config.optionMergeStrategies.customOption = function (parentVal, childVal) {
              const res = parentVal ? parentVal.slice() : []
              if (childVal) {
                res.push(childVal)
              }
              return res
            }
            Vue.config.optionMergeStrategies.numericOption = function (parentVal, childVal) {
              return childVal !== undefined ? childVal : parentVal
            }
        }
      },

      // åˆå§‹åŒ–é€‰é¡¹
      created: function () {
        // åˆå§‹é’©å­å‡½æ•°
      },
      customOption: 'ç»„ä»¶è‡ªèº« customOption',
      numericOption: 3
    })
  </script>
</body>

</html>