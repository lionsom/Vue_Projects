import{_ as F,P as O,a as T}from"./pdf.worker-DEE9xRSj.js";import{d as h,r as n,o as $,v as N,e as g,f as k,g as D,h as i,k as v,i as _,j as x,l as U,F as j,p as E}from"./index-DG13FsbX.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"top-container"},A={class:"bottom-container"},G={name:"PdfOnceViewer"},J=h({...G,setup(b){const c=n(1),d=n(100),P=n("default"),w=n(!1),S=n(!1),C=a=>{console.log(`${a} items per page`)},z=a=>{console.log(`current page: ${a}`),f(a)};let m=null,p=n(0),y=n("https://raw.githubusercontent.com/lionsom/imagesRepo/xishanlin/genealogy/莆田林氏西山本支族谱(卷一).pdf"),B=n(1.3);$(()=>{R(y.value)});const R=async a=>{F.workerSrc=JSON.stringify(O),T(a).promise.then(t=>{t.loadingParams.disableAutoFetch=!0,t.loadingParams.disableStream=!0,m=t,p.value=t.numPages,console.log("pdfPages = ",p.value),N(()=>{f(1)})}).catch(t=>{console.warn(`[upthen] pdfReader loadFile error: ${t}`)})},f=a=>{m.getPage(a).then(e=>{e.cleanup();const t=document.getElementById("pdf-canvas");if(t){const o=t.getContext("2d"),u=window.devicePixelRatio||1,s=o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1,l=u/s,r=e.getViewport({scale:B.value});t.width=r.width*l,t.height=r.height*l,t.style.width=r.width+"px",t.style.height=r.height+"px",o.setTransform(l,0,0,l,0,0);const V={canvasContext:o,viewport:r};e.render(V)}})};return(a,e)=>{const t=g("el-button"),o=g("el-scrollbar"),u=g("el-pagination");return k(),D(j,null,[i("div",W,[e[3]||(e[3]=v(" 我是top部：第一页 ")),_(t,{type:"primary"},{default:x(()=>e[2]||(e[2]=[v(" 下载 ")])),_:1})]),_(o,{class:"container-main"},{default:x(()=>e[4]||(e[4]=[i("div",{class:"main-center"},[i("canvas",{id:"pdf-canvas"})],-1)])),_:1}),i("div",A,[_(u,{"current-page":c.value,"onUpdate:currentPage":e[0]||(e[0]=s=>c.value=s),"page-size":d.value,"onUpdate:pageSize":e[1]||(e[1]=s=>d.value=s),size:P.value,disabled:S.value,background:w.value,layout:"prev, pager, next, jumper",total:U(p),onSizeChange:C,onCurrentChange:z},null,8,["current-page","page-size","size","disabled","background","total"])])],64)}}}),M=I(J,[["__scopeId","data-v-4e6fc2ff"]]),q={name:"PDFOnceView"},Q=h({...q,setup(b){return(c,d)=>(k(),E(M))}});export{Q as default};
